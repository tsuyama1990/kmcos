!  This file was generated by kmcos (kinetic Monte Carlo of Systems)
!  written by Max J. Hoffmann mjhoffmann@gmail.com (C) 2009-2013.
!  The model was written by Tomoyuki TSUYAMA.

!  This file is part of kmcos.
!
!  kmcos is free software; you can redistribute it and/or modify
!  it under the terms of the GNU General Public License as published by
!  the Free Software Foundation; either version 2 of the License, or
!  (at your option) any later version.
!
!  kmcos is distributed in the hope that it will be useful,
!  but WITHOUT ANY WARRANTY; without even the implied warranty of
!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!  GNU General Public License for more details.
!
!  You should have received a copy of the GNU General Public License
!  along with kmcos; if not, write to the Free Software
!  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301
!  USA
module proclist_pars
use kind_values
use base, only: &
    rates
use proclist_constants
use lattice, only: &
    ru_slab, &
    ru_slab_p1, &
    ru_slab_p2, &
    get_species

implicit none

! User parameters
integer(kind=iint), public :: T = 1
integer(kind=iint), public :: de_act = 2
integer(kind=iint), public :: ips_per_n = 3
real(kind=rdouble), public, dimension(3) :: userpar

! Constants
real(kind=rdouble), parameter :: eV = 1.6021765650e-19
real(kind=rdouble), parameter :: kboltzmann = 1.3806488000e-23

! Species masses
character(len=45), parameter, public :: byst_ru_interaction_0 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_1 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_10 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_11 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_12 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_13 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_14 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_15 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_16 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_17 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_18 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_19 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_2 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_20 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_21 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_22 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_23 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_3 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_4 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_5 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_6 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_7 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_8 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"
character(len=45), parameter, public :: byst_ru_interaction_9 = "nr_rn_n1org &
    &nr_ru_n1org &
    &nr_rn_n1ts &
    &nr_ru_n1ts"

contains
subroutine update_user_parameter(param,val)
    integer(kind=iint), intent(in) :: param
    real(kind=rdouble), intent(in) :: val
    userpar(param) = val
end subroutine update_user_parameter

subroutine get_user_parameter(param,val)
    integer(kind=iint), intent(in) :: param
    real(kind=rdouble), intent(out) :: val
    val = userpar(param)
end subroutine get_user_parameter


function gr_ru_interaction_0(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_0

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-2, -2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-2, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-2, -2, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-2, -2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -2, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_0 = rate_ru_interaction_0(nr_vars)
    return

end function gr_ru_interaction_0

function rate_ru_interaction_0(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_0
    rate_ru_interaction_0 = rates (ru_interaction_0 ) * exp (- (1 / (&
    &kboltzmann  * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_0


function gr_ru_interaction_1(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_1

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-2, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-2, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-2, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-2, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_1 = rate_ru_interaction_1(nr_vars)
    return

end function gr_ru_interaction_1

function rate_ru_interaction_1(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_1
    rate_ru_interaction_1 = rates (ru_interaction_1 ) * exp (- (1 / (&
    &kboltzmann  * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_1


function gr_ru_interaction_10(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_10

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, -1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, -1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_10 = rate_ru_interaction_10(nr_vars)
    return

end function gr_ru_interaction_10

function rate_ru_interaction_10(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_10
    rate_ru_interaction_10 = rates (ru_interaction_10 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_10


function gr_ru_interaction_11(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_11

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_11 = rate_ru_interaction_11(nr_vars)
    return

end function gr_ru_interaction_11

function rate_ru_interaction_11(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_11
    rate_ru_interaction_11 = rates (ru_interaction_11 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_11


function gr_ru_interaction_12(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_12

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-2, -2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-2, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_12 = rate_ru_interaction_12(nr_vars)
    return

end function gr_ru_interaction_12

function rate_ru_interaction_12(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_12
    rate_ru_interaction_12 = rates (ru_interaction_12 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_12


function gr_ru_interaction_13(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_13

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-2, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-2, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_13 = rate_ru_interaction_13(nr_vars)
    return

end function gr_ru_interaction_13

function rate_ru_interaction_13(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_13
    rate_ru_interaction_13 = rates (ru_interaction_13 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_13


function gr_ru_interaction_14(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_14

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_14 = rate_ru_interaction_14(nr_vars)
    return

end function gr_ru_interaction_14

function rate_ru_interaction_14(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_14
    rate_ru_interaction_14 = rates (ru_interaction_14 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_14


function gr_ru_interaction_15(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_15

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 2, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 2, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_15 = rate_ru_interaction_15(nr_vars)
    return

end function gr_ru_interaction_15

function rate_ru_interaction_15(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_15
    rate_ru_interaction_15 = rates (ru_interaction_15 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_15


function gr_ru_interaction_16(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_16

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_16 = rate_ru_interaction_16(nr_vars)
    return

end function gr_ru_interaction_16

function rate_ru_interaction_16(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_16
    rate_ru_interaction_16 = rates (ru_interaction_16 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_16


function gr_ru_interaction_17(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_17

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 2, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 2, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_17 = rate_ru_interaction_17(nr_vars)
    return

end function gr_ru_interaction_17

function rate_ru_interaction_17(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_17
    rate_ru_interaction_17 = rates (ru_interaction_17 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_17


function gr_ru_interaction_18(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_18

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_18 = rate_ru_interaction_18(nr_vars)
    return

end function gr_ru_interaction_18

function rate_ru_interaction_18(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_18
    rate_ru_interaction_18 = rates (ru_interaction_18 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_18


function gr_ru_interaction_19(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_19

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_19 = rate_ru_interaction_19(nr_vars)
    return

end function gr_ru_interaction_19

function rate_ru_interaction_19(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_19
    rate_ru_interaction_19 = rates (ru_interaction_19 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_19


function gr_ru_interaction_2(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_2

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -2, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -2, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_2 = rate_ru_interaction_2(nr_vars)
    return

end function gr_ru_interaction_2

function rate_ru_interaction_2(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_2
    rate_ru_interaction_2 = rates (ru_interaction_2 ) * exp (- (1 / (&
    &kboltzmann  * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_2


function gr_ru_interaction_20(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_20

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_20 = rate_ru_interaction_20(nr_vars)
    return

end function gr_ru_interaction_20

function rate_ru_interaction_20(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_20
    rate_ru_interaction_20 = rates (ru_interaction_20 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_20


function gr_ru_interaction_21(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_21

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 2, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 2, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_21 = rate_ru_interaction_21(nr_vars)
    return

end function gr_ru_interaction_21

function rate_ru_interaction_21(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_21
    rate_ru_interaction_21 = rates (ru_interaction_21 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_21


function gr_ru_interaction_22(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_22

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_22 = rate_ru_interaction_22(nr_vars)
    return

end function gr_ru_interaction_22

function rate_ru_interaction_22(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_22
    rate_ru_interaction_22 = rates (ru_interaction_22 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_22


function gr_ru_interaction_23(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_23

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 2, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 2, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_23 = rate_ru_interaction_23(nr_vars)
    return

end function gr_ru_interaction_23

function rate_ru_interaction_23(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_23
    rate_ru_interaction_23 = rates (ru_interaction_23 ) * exp (- (1 / &
    &( kboltzmann * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_23


function gr_ru_interaction_3(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_3

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_3 = rate_ru_interaction_3(nr_vars)
    return

end function gr_ru_interaction_3

function rate_ru_interaction_3(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_3
    rate_ru_interaction_3 = rates (ru_interaction_3 ) * exp (- (1 / (&
    &kboltzmann  * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_3


function gr_ru_interaction_4(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_4

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_4 = rate_ru_interaction_4(nr_vars)
    return

end function gr_ru_interaction_4

function rate_ru_interaction_4(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_4
    rate_ru_interaction_4 = rates (ru_interaction_4 ) * exp (- (1 / (&
    &kboltzmann  * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_4


function gr_ru_interaction_5(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_5

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/2, 2, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_5 = rate_ru_interaction_5(nr_vars)
    return

end function gr_ru_interaction_5

function rate_ru_interaction_5(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_5
    rate_ru_interaction_5 = rates (ru_interaction_5 ) * exp (- (1 / (&
    &kboltzmann  * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_5


function gr_ru_interaction_6(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_6

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-2, -2, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-2, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -2, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, -1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_6 = rate_ru_interaction_6(nr_vars)
    return

end function gr_ru_interaction_6

function rate_ru_interaction_6(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_6
    rate_ru_interaction_6 = rates (ru_interaction_6 ) * exp (- (1 / (&
    &kboltzmann  * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_6


function gr_ru_interaction_7(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_7

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-2, -2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-2, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_7 = rate_ru_interaction_7(nr_vars)
    return

end function gr_ru_interaction_7

function rate_ru_interaction_7(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_7
    rate_ru_interaction_7 = rates (ru_interaction_7 ) * exp (- (1 / (&
    &kboltzmann  * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_7


function gr_ru_interaction_8(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_8

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -2, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -2, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, -1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_8 = rate_ru_interaction_8(nr_vars)
    return

end function gr_ru_interaction_8

function rate_ru_interaction_8(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_8
    rate_ru_interaction_8 = rates (ru_interaction_8 ) * exp (- (1 / (&
    &kboltzmann  * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_8


function gr_ru_interaction_9(cell)
    integer(kind=iint), dimension(4), intent(in) :: cell
    integer(kind=iint), dimension(4) :: nr_vars
    real(kind=rdouble) :: gr_ru_interaction_9

    nr_vars(:) = 0
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/1, 1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, -1, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, -1, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(2) = nr_vars(2) + 1
        case(rn)
            nr_vars(1) = nr_vars(1) + 1
    end select
    select case(get_species(cell + (/-1, -2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/-1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -2, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, -1, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p2/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, -1, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/0, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 0, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select
    select case(get_species(cell + (/1, 0, 1, ru_slab_p1/)))
        case(ru)
            nr_vars(4) = nr_vars(4) + 1
        case(rn)
            nr_vars(3) = nr_vars(3) + 1
    end select

    gr_ru_interaction_9 = rate_ru_interaction_9(nr_vars)
    return

end function gr_ru_interaction_9

function rate_ru_interaction_9(nr_vars)

    integer(kind=iint), dimension(4), intent(in) :: nr_vars

    real(kind=rdouble) :: rate_ru_interaction_9
    rate_ru_interaction_9 = rates (ru_interaction_9 ) * exp (- (1 / (&
    &kboltzmann  * userpar(T) ) ) * (userpar(de_act) + (nr_vars(4) - &
    &nr_vars(2)  ) * userpar(ips_per_n) ) * eV ) * (1 / (1 + exp (- &
    &1e30  * (nr_vars(4) - 1 / 2 ) ) ) ) * exp ((1 / (kboltzmann * &
    &userpar(T)  ) ) * (nr_vars(3) - nr_vars(1) ) * 1 * eV )   

    return

end function rate_ru_interaction_9


end module proclist_pars
